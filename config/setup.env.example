# Copy to config/setup.env and fill. Do NOT commit real tokens/keys.

# -------- Proxy (China/GFW) --------
# Example: http://127.0.0.1:7897 (Clash)
OPENCLAW_PROXY_URL=
NO_PROXY=127.0.0.1,localhost,::1

# -------- OpenClaw (optional) --------
# Install version (npm). Leave empty for latest.
OPENCLAW_VERSION=2026.2.12

# If you want OpenClaw itself on Discord, set this.
OPENCLAW_DISCORD_BOT_TOKEN=
# Optionally allowlist a specific guild+channel (recommended)
OPENCLAW_DISCORD_GUILD_ID=
OPENCLAW_DISCORD_CHANNEL_ID=

# Optional: disable built-in web search tool to avoid Brave-key errors.
OPENCLAW_DISABLE_BUILTIN_WEB_SEARCH=true

# -------- Codex Discord Relay (required for "Codex via Discord") --------
CODEX_DISCORD_BOT_TOKEN=
# Optional allowlists (comma-separated). Channel allowlist applies to guild channels only.
CODEX_ALLOWED_GUILDS=
CODEX_ALLOWED_CHANNELS=

# Codex runtime defaults
CODEX_WORKDIR=/root
CODEX_ALLOWED_WORKDIR_ROOTS=/root
CODEX_MODEL=
# Public-safe baseline. For higher convenience (and higher risk), you may switch
# to `danger-full-access` and `never` in trusted private environments.
CODEX_SANDBOX=workspace-write
CODEX_APPROVAL_POLICY=on-request
# Compatibility alias used by some relay revisions:
CODEX_APPROVAL=on-request
CODEX_ENABLE_SEARCH=true
CODEX_SKIP_GIT_REPO_CHECK=true

# Relay execution behavior
RELAY_AGENT_PROVIDER=codex
RELAY_AGENT_TIMEOUT_MS=600000
RELAY_THREAD_AUTO_RESPOND=true

# Relay task queue (/task)
RELAY_TASKS_ENABLED=true
RELAY_TASKS_MAX_PENDING=50
RELAY_TASKS_STOP_ON_ERROR=false
RELAY_TASKS_POST_FULL_OUTPUT=true
RELAY_TASKS_SUMMARY_AFTER_RUN=true

# Git worktrees (/worktree)
# Default is `${RELAY_STATE_DIR}/worktrees` when unset. Must be under CODEX_ALLOWED_WORKDIR_ROOTS.
# RELAY_WORKTREE_ROOT_DIR=/root/.codex-discord-relay/worktrees

# Agent relay actions (agent -> relay automation)
# Allows the agent to request privileged relay-side actions by outputting:
#   [[relay-actions]]{"actions":[...]}[[/relay-actions]]
# Disabled by default for safety; DM-only by default.
RELAY_AGENT_ACTIONS_ENABLED=false
RELAY_AGENT_ACTIONS_DM_ONLY=true
RELAY_AGENT_ACTIONS_ALLOWED=job_start,job_stop,job_watch
RELAY_AGENT_ACTIONS_MAX_PER_MESSAGE=1
RELAY_MAX_JOB_COMMAND_CHARS=12000

# Jobs auto-watch defaults (used when relay actions start/watch a job).
# Default is true only when actions are enabled.
RELAY_JOBS_AUTO_WATCH=true
RELAY_JOBS_AUTO_WATCH_EVERY_SEC=300
RELAY_JOBS_AUTO_WATCH_TAIL_LINES=50
# Relay-native supervisor Phase 1 (disabled by default)
RELAY_SUPERVISOR_PHASE1_ENABLED=false
RELAY_SUPERVISOR_PHASE1_DEFAULT_SCRIPT=scripts/stage0_smoke_gate.py
RELAY_SUPERVISOR_PHASE1_DEFAULT_EXPECT_STATUS=success
RELAY_SUPERVISOR_PHASE1_DEFAULT_READY_TIMEOUT_SEC=900
RELAY_SUPERVISOR_PHASE1_DEFAULT_READY_POLL_SEC=15

# Research manager (/research)
# Disabled by default; DM-only by default.
RELAY_RESEARCH_ENABLED=false
RELAY_RESEARCH_DM_ONLY=true
# Must stay inside CODEX_ALLOWED_WORKDIR_ROOTS.
RELAY_RESEARCH_PROJECTS_ROOT=/root/.codex-discord-relay/projects
RELAY_RESEARCH_DEFAULT_MAX_STEPS=50
RELAY_RESEARCH_DEFAULT_MAX_WALLCLOCK_MIN=480
RELAY_RESEARCH_DEFAULT_MAX_RUNS=30
RELAY_RESEARCH_TICK_SEC=30
RELAY_RESEARCH_TICK_MAX_PARALLEL=2
RELAY_RESEARCH_LEASE_TTL_SEC=300
RELAY_RESEARCH_INFLIGHT_TTL_SEC=900
RELAY_RESEARCH_POST_ON_APPLIED=true
RELAY_RESEARCH_POST_ON_BLOCKED=true
RELAY_RESEARCH_POST_EVERY_STEPS=5
RELAY_RESEARCH_MAX_ACTIONS_PER_STEP=12
RELAY_RESEARCH_REQUIRE_NOTE_PREFIX=false
# Separate allowlist from general [[relay-actions]].
RELAY_RESEARCH_ACTIONS_ALLOWED=job_start,job_watch,job_stop,task_add,task_run,write_report,research_pause,research_mark_done

# Plans (/plan)
RELAY_PLANS_ENABLED=true
RELAY_PLANS_MAX_HISTORY=20
RELAY_PLAN_APPLY_REQUIRE_CONFIRM_IN_GUILDS=true

# Handoff + working memory (/handoff)
# Semicolon-separated list; relative paths resolve against repo root when inside a git repo.
RELAY_HANDOFF_ENABLED=true
RELAY_HANDOFF_FILES="HANDOFF_LOG.md;docs/WORKING_MEMORY.md"
# Legacy knob: if true, auto-write a handoff entry after task runs and plan applies.
RELAY_HANDOFF_AUTO_ENABLED=false
# Preferred knobs:
RELAY_AUTO_HANDOFF_AFTER_EACH_TASK=false
RELAY_AUTO_HANDOFF_AFTER_TASK_RUN=false
RELAY_AUTO_HANDOFF_AFTER_PLAN_APPLY=false
# Optional git automation (git repos only):
RELAY_HANDOFF_GIT_AUTO_COMMIT=false
RELAY_HANDOFF_GIT_AUTO_PUSH=false
RELAY_HANDOFF_GIT_COMMIT_MESSAGE="chore: relay handoff"

# Optional: auto-commit arbitrary repo changes after successful tasks/plan apply (never auto-push).
RELAY_GIT_AUTO_COMMIT=false
RELAY_GIT_AUTO_COMMIT_SCOPE=both
# Values: task|plan|both
RELAY_GIT_COMMIT_PREFIX="ai:"

# Relay progress updates
RELAY_PROGRESS=true
RELAY_PROGRESS_MIN_EDIT_MS=5000
RELAY_PROGRESS_HEARTBEAT_MS=20000
RELAY_PROGRESS_MAX_LINES=6
RELAY_PROGRESS_SHOW_COMMANDS=false
# Optional durable progress notes in-thread (keep transient command traces in edited Running message).
RELAY_PROGRESS_PERSISTENT_ENABLED=false
RELAY_PROGRESS_PERSISTENT_EVERY_MS=45000
RELAY_PROGRESS_PERSISTENT_ORCHESTRATOR_EVERY_MS=15000
RELAY_PROGRESS_PERSISTENT_MAX_PER_RUN=6
# all | narrative | narrative+milestones | narrative+milestones+orchestrator | off
RELAY_PROGRESS_PERSISTENT_MODE=narrative+milestones+orchestrator
RELAY_PROGRESS_PERSISTENT_MIN_CHARS=32
RELAY_PROGRESS_PERSISTENT_MAX_CHARS=320

# Relay global context â€” injected into every agent message so agents always have
# current context (speech-to-text note, ecosystem info, key paths) without resets.
RELAY_CONTEXT_ENABLED=true
RELAY_CONTEXT_EVERY_TURN=true
# Increase to force one-time re-bootstrap for existing sessions.
RELAY_CONTEXT_VERSION=1
# Semicolon-separated context specs. Prefix modes: head:, tail:, headtail:
# Relative paths resolve against the current session workdir.
RELAY_CONTEXT_FILE="/root/.codex-discord-relay/global-context.md;tail:docs/WORKING_MEMORY.md;tail:HANDOFF_LOG.md;tail:/root/SYSTEM_SETUP_WORKING_MEMORY.md;tail:/root/HANDOFF_LOG.md"
RELAY_CONTEXT_MAX_CHARS=40000
RELAY_CONTEXT_MAX_CHARS_PER_FILE=20000

# Incoming Discord attachments (small text files)
# If enabled, the relay downloads small text attachments into:
#   <upload_dir>/attachments/
# and appends their contents to the prompt automatically.
RELAY_DISCORD_ATTACHMENTS_ENABLED=true
RELAY_DISCORD_ATTACHMENTS_MAX_FILES=3
RELAY_DISCORD_ATTACHMENTS_MAX_BYTES=262144
RELAY_DISCORD_ATTACHMENTS_MAX_CHARS=20000
RELAY_DISCORD_ATTACHMENTS_MAX_CHARS_PER_FILE=8000
RELAY_DISCORD_ATTACHMENTS_DOWNLOAD_TIMEOUT_MS=15000

# Relay upload bridge
# Allows [[upload:...]] markers from agent output and /upload <path>.
# Images typically render inline in Discord; text/PDF and other files remain downloadable.
RELAY_UPLOAD_ENABLED=true
# Public-safe defaults:
# - keep uploads scoped to active conversation context
# - avoid broad roots like /root unless you understand the exposure risk
RELAY_UPLOAD_ALLOW_OUTSIDE_CONVERSATION=false
RELAY_UPLOAD_ALLOWED_ROOTS=/tmp
RELAY_UPLOAD_MAX_FILES=3
RELAY_UPLOAD_MAX_BYTES=8388608

# Advanced
CODEX_BIN=codex
NODE_BIN=

# -------- Packaged Skills (local Codex skills) --------
# Installs skills bundled in this repo into $CODEX_HOME/skills (or ~/.codex/skills).
OPENCLAW_INSTALL_PACKAGED_SKILLS=true
# Optional subset (comma-separated names from packaged-skills/codex):
# OPENCLAW_PACKAGED_SKILLS_ONLY=discord-image-upload,openclaw-media-send
# Optional target override:
# OPENCLAW_PACKAGED_SKILLS_TARGET=/root/.codex/skills
# Whether to overwrite existing installed skill dirs:
OPENCLAW_PACKAGED_SKILLS_OVERWRITE=true
# Optional: sync local skills into packaged-skills/codex during bootstrap.
OPENCLAW_SYNC_LOCAL_SKILLS_ON_BOOTSTRAP=false
# Comma-separated local skill names to package.
OPENCLAW_LOCAL_SKILLS_TO_PACKAGE=tavily-search,delegate-coding-tasks

# -------- Global Agent Context (AGENTS / CLAUDE / OVERVIEW) --------
# Auto-install template context files during bootstrap.
OPENCLAW_INSTALL_GLOBAL_CONTEXT=true
# Never overwrite existing context files unless explicitly enabled.
OPENCLAW_GLOBAL_CONTEXT_OVERWRITE=false
# Target home for installed files (must be absolute path).
OPENCLAW_GLOBAL_CONTEXT_TARGET_HOME=/root

# -------- Machine State Snapshot (machine -> repo, repo -> machine) --------
# Redact secrets by default. Set true only for trusted/private repos.
OPENCLAW_STATE_SYNC_INCLUDE_SECRETS=false
# Snapshot location inside this repository:
OPENCLAW_STATE_SYNC_OUTPUT_DIR=
# Skills captured by export_local_state.sh
OPENCLAW_STATE_SYNC_OPENCLAW_SKILLS=tavily-search,delegate-coding-tasks
OPENCLAW_STATE_SYNC_CODEX_SKILLS=
# Optional bootstrap hooks:
OPENCLAW_APPLY_SNAPSHOT_ON_BOOTSTRAP=false
OPENCLAW_EXPORT_SNAPSHOT_ON_BOOTSTRAP=false
# sync_local_state_to_repo.sh defaults:
OPENCLAW_STATE_SYNC_COMMIT=true
OPENCLAW_STATE_SYNC_PUSH=false
OPENCLAW_STATE_SYNC_COMMIT_MESSAGE=chore: sync local machine state snapshot
# Optional cron-based machine->repo sync (disabled by default):
OPENCLAW_STATE_SYNC_CRON_ENABLED=false
# Daily at 03:05 local time (avoid overlapping with autoupdate at 03:17).
OPENCLAW_STATE_SYNC_CRON=5 3 * * *
# OPENCLAW_STATE_SYNC_LOG=/var/log/openclaw-state-sync.log

# -------- Toolkit Auto-Update (systemd timer) --------
# Enables periodic git pull + deploy reconciliation for this toolkit repo.
OPENCLAW_KIT_AUTOUPDATE_ENABLED=true
# Examples: daily, weekly, *-*-* 03:00:00, Mon *-*-* 04:00:00
OPENCLAW_KIT_AUTOUPDATE_CALENDAR=daily
# Add jitter so many hosts don't hit remote at the same time.
OPENCLAW_KIT_AUTOUPDATE_RANDOMIZED_DELAY=30m
OPENCLAW_KIT_AUTOUPDATE_PERSISTENT=true
# Optional overrides:
# OPENCLAW_KIT_AUTOUPDATE_REPO_DIR=/root/VibeResearch_toolkit
# OPENCLAW_KIT_AUTOUPDATE_LOG=/var/log/openclaw-kit-autoupdate.log
# Cron fallback used only when systemd is unavailable:
# OPENCLAW_KIT_AUTOUPDATE_CRON=17 3 * * *
